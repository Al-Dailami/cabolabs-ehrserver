<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>EHRServer by ppazos</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>EHRServer</h1>
        <h2>Service-oriented openEHR repository for clinical data with composition commit, query and retrieve capabilities.</h2>
        <a href="https://github.com/ppazos/cabolabs-ehrserver" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="cabolabs-ehrserver" class="anchor" href="#cabolabs-ehrserver" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CaboLabs EHRServer</h1>

<p><a href="https://travis-ci.org/ppazos/cabolabs-ehrserver"><img src="https://travis-ci.org/ppazos/cabolabs-ehrserver.svg?branch=master" alt="Build Status"></a></p>

<h2>
<a id="service-oriented-clinical-data-repository-for-shared-ehrsemrsphrs-based-on-the-openehr-standard" class="anchor" href="#service-oriented-clinical-data-repository-for-shared-ehrsemrsphrs-based-on-the-openehr-standard" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Service-oriented clinical data repository for shared EHRs/EMRs/PHRs based on the <a href="http://openehr.org">openEHR standard</a>.</h2>

<h3>
<a id="latest-documentation" class="anchor" href="#latest-documentation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="http://cabolabs.com/en/projects">Latest documentation</a>
</h3>

<h3>
<a id="main-services" class="anchor" href="#main-services" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Main Services:</h3>

<ul>
<li>clinical data commit</li>
<li>clinical data query (with aggregation and grouping capabilities)</li>
<li>data synchronization (for backup and server clustering)</li>
</ul>

<h3>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Features:</h3>

<ul>
<li>multiformat XML/JSON</li>
<li>web services (REST and SOAP)</li>
<li>versioned openEHR objects</li>
<li>data indexing</li>
</ul>

<h3>
<a id="main-functionalities" class="anchor" href="#main-functionalities" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Main functionalities:</h3>

<ul>
<li>Patient management</li>
<li>EHR and contributions management</li>
<li>Query building and testing</li>
<li>Usage logs</li>
</ul>

<h2>
<a id="the-project" class="anchor" href="#the-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The project</h2>

<h3>
<a id="intended-audience" class="anchor" href="#intended-audience" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Intended audience</h3>

<ul>
<li>Clinical Record Managers</li>
<li>EHR/EMR/PHR System Admins</li>
<li>Healthcare Informatics Trainers &amp; Students</li>
</ul>

<h3>
<a id="technologies" class="anchor" href="#technologies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Technologies</h3>

<ul>
<li><a href="http://grails.org">Grails Framework</a></li>
<li><a href="http://groovy.codehaus.org">Groovy</a></li>
<li><a href="http://docs.oracle.com/javase/specs">Java</a></li>
</ul>

<h3>
<a id="out-of-scope" class="anchor" href="#out-of-scope" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Out of scope</h3>

<ul>
<li>EHR/EMR/PHR apps should be written separately as clients of the EHRServer, but use the provided data services to access and send data from/to the EHRServer.</li>
<li>Data analysis, data aggregation, business intelligence and other data processing related applications should be written separately from the EHRServer, all those systems can get data from the EHRServer using the provided data services.</li>
</ul>

<h2>
<a id="rest-api" class="anchor" href="#rest-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>REST API</h2>

<h3>
<a id="get-ehrs" class="anchor" href="#get-ehrs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get EHRs</h3>

<p>/rest/ehrs(String format:xml|json, int max, int offset)</p>

<h3>
<a id="get-patients-this-service-will-be-obsolete-when-we-move-patient-data-to-a-specific-demographic-repo" class="anchor" href="#get-patients-this-service-will-be-obsolete-when-we-move-patient-data-to-a-specific-demographic-repo" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get patients (this service will be obsolete when we move patient data to a specific demographic repo)</h3>

<p>/rest/patients(String format:xml|json, int max, int offset)</p>

<h3>
<a id="get-one-patient-by-uid" class="anchor" href="#get-one-patient-by-uid" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get one patient by uid</h3>

<p>/rest/patients/{uid}(String format:xml|json, int max, int offset)</p>

<h3>
<a id="get-ehr-for-a-subject-patient" class="anchor" href="#get-ehr-for-a-subject-patient" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get EHR for a subject (patient)</h3>

<p>/rest/ehrs/subjectUid/{subjectUid}(String format:xml|json)</p>

<h3>
<a id="get-ehr-by-uid" class="anchor" href="#get-ehr-by-uid" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get EHR by uid</h3>

<p>/rest/ehrs/ehrUid/{ehrUid}(String format:xml|json)</p>

<h3>
<a id="get-all-compositions-for-a-patient" class="anchor" href="#get-all-compositions-for-a-patient" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get all compositions for a patient</h3>

<p>/rest/findCompositions(String ehrId)</p>

<h3>
<a id="get-query-definitions" class="anchor" href="#get-query-definitions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get query definitions</h3>

<p>/rest/queries(String format:xml|json, int max, int offset)</p>

<h3>
<a id="get-one-query-by-its-uid" class="anchor" href="#get-one-query-by-its-uid" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get one query by it's uid</h3>

<p>/rest/queries/{queryUid}</p>

<h3>
<a id="query-execution-by-uid" class="anchor" href="#query-execution-by-uid" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Query execution by uid</h3>

<p>/rest/queries/{queryUid}/execute(String organizationUid, String ehrId)</p>

<h3>
<a id="commits-a-set-of-clinical-documents-to-the-ehr" class="anchor" href="#commits-a-set-of-clinical-documents-to-the-ehr" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Commits a set of clinical documents to the EHR</h3>

<p>/rest/commit(String ehrUid, Version[] versions, String auditSystemId, String auditCommitter)</p>

<p>Versions should be committed in XML, following this XSD: <a href="https://github.com/ppazos/cabolabs-ehrserver/blob/master/xsd/Version.xsd">https://github.com/ppazos/cabolabs-ehrserver/blob/master/xsd/Version.xsd</a></p>

<h4>
<a id="rules-for-versions-commit-checkout-and-version-control" class="anchor" href="#rules-for-versions-commit-checkout-and-version-control" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rules for VERSIONs (commit, checkout and version control)</h4>

<ul>
<li>The XML should be valid against the XSD (see /xsd folder in project).</li>
<li>version.uid should have this format: versioned_object_id::creating_system_id::version_tree_id.

<ul>
<li>The 3 fields of the version.uid attribute should be set by the client.</li>
<li>When committing a new Version, the client should assign: a_generated_uid::client_system_id::1</li>
<li>The first commit of a Version will generate on the EHRServer a new VersionedObject that contains that Version.</li>
<li>The versionedObject.uid will be equal to the first part of the version.uid</li>
<li>When committing a change to an existing VersionedObject, the version.uid should be equal to the uid of the version that was checked out and to which the changes were apply.</li>
<li>When receiving a new Version for an existing VersionedObject, the EHRServer will update the versio_tree_id, generating uid::system::1, uid::system::2, uid::system::3, ... for each version.uid of the same VersionedObject.</li>
</ul>
</li>
<li>remember to use the archetype_id in the archetype_node_id attribute, of all the LOCATABLE elements
inside version.data, when the node_id is 'at0000' (root node).</li>
<li>for the encoding element in ENTRIES use 'Unicode' as the terminology and 'UTF-8' as the code_string,
and be sure that the XML content is encoded with UTF-8.</li>
<li>version.commit_audit.time_committed that is set by client apps will be overriden by the server
to be compliant with this rule from the openEHR specs:

<ul>
<li>The time_committed attribute in both the Contribution and Version audits <strong>should reflect the time
of committal to an EHR server, i.e. the time of availability to other users</strong> in the same system.
It should therefore be computed on the server in implementations where the data are created
in a separate client context.</li>
</ul>
</li>
</ul>

<h4>
<a id="rules-for-contributions" class="anchor" href="#rules-for-contributions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rules for CONTRIBUTIONs</h4>

<ul>
<li>The parameters <em>auditSystemId</em>, <em>auditTimeCommitted</em> and <em>auditCommitter</em> are used to create the CONTRIBUTION for each commit.
To be compliant with the openEHR specs, the client system should use that data to create the VERSION.commit_audit structure. So
this rule is met:

<ul>
<li>"CONTRIBUTION.audit captures to the time, place and committer of the committal act; these three attributes (system_id,
committer, time_committed of AUDIT_DETAILS) should be copied into the corresponding attributes of the commit_audit of each VERSION included in the CONTRIBUTION..."</li>
</ul>
</li>
</ul>

<h3>
<a id="ehrserver-workflows-supported-by-clients" class="anchor" href="#ehrserver-workflows-supported-by-clients" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>EHRServer workflows supported by clients</h3>

<h4>
<a id="wf1-commit" class="anchor" href="#wf1-commit" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>WF1. Commit</h4>

<p>A client applicaton can commit one or more versions of different Compositions in one transaction.</p>

<h4>
<a id="wf2-query" class="anchor" href="#wf2-query" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>WF2. Query</h4>

<p>Query execution by UID. Queries are created by admins. In the near future we'll add an API to create and manage Queries from client applications. We'll also explore adding support to AQL queries.</p>

<h4>
<a id="wf3-checkout-and-commit-versioned-clinical-documents" class="anchor" href="#wf3-checkout-and-commit-versioned-clinical-documents" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>WF3. Checkout and Commit (versioned clinical documents)</h4>

<p>On checkout, the client will receive a copy of an existing version of a Composition, with the current UID. The client can modify, and commit, and the same UID should be used. Then the EHRServer will update the version number in the new Version UID. Then Queries will get data only from the latest Version of the existing Compositions. All the Versions of a Composition are grouped in a VersionedComposition object.</p>

<h3>
<a id="milestones-and-deliverables" class="anchor" href="#milestones-and-deliverables" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Milestones and deliverables</h3>

<h4>
<a id="m1-basic-services-in-xml-and-json-and-internal-operations" class="anchor" href="#m1-basic-services-in-xml-and-json-and-internal-operations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>M1. Basic services in XML and JSON and internal operations</h4>

<ul>
<li>list and show of EHRs, Compositions, Queries and Contributions</li>
<li>commit reception (just openEHR XML for now)</li>
<li>data indexing operation</li>
<li>openEHR archetype definition indexing</li>
</ul>

<h4>
<a id="m2-gui-to-manage-internal-data-list-show-create-edit-delete" class="anchor" href="#m2-gui-to-manage-internal-data-list-show-create-edit-delete" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>M2. GUI to manage internal data (list, show, create, edit, delete)</h4>

<ul>
<li>EHR management</li>
<li>Directory management</li>
<li>Composition management</li>
<li>Query management</li>
<li>Contribution management</li>
<li>Patient management (should be externalized to a demographic server)</li>
<li>User management</li>
</ul>

<h4>
<a id="m3-advanced-features-each-one-could-be-a-milestone-itself" class="anchor" href="#m3-advanced-features-each-one-could-be-a-milestone-itself" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>M3. Advanced features (each one could be a milestone itself)</h4>

<ul>
<li>Support rules for directory management (copying and moving compositions between folders)</li>
<li>Composition versioning</li>
<li>Persistent composition support</li>
<li>Querying versioned objects</li>
<li>Data syncrhonization between servers</li>
<li>Support for AQL/EQL output (openEHR archetype-based query language)</li>
</ul>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/ppazos/cabolabs-ehrserver/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/ppazos/cabolabs-ehrserver/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/ppazos/cabolabs-ehrserver"></a> is maintained by <a href="https://github.com/ppazos">ppazos</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
